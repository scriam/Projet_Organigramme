
var pubs = 
        {
  "name": "DCX",
  "children": [
    {
      "name": "ORANGE SF",
      "children": [
        {
          "name": "SalesForce",
          "children": [
            {
              "name": "KENEME  Fatou"
            },
            {
              "name": "KRIBII Loubna CRM"
            },
            {
              "name": "Etienne Gaspard"
            },
            {
              "name": "JIMENEZ  Juan-Manuel"
            },
            {
              "name": "SAIER Olivier"
            },
            {
              "name": "AMOKRANE Yanis"
            },
            {
              "name": "ESCALADA HERNÁNDEZ Miguel"
            }
          ]
        }
      ]
    },
    {
      "name": "BDF",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "BANTO Anca"
            }
          ]
        }
      ]
    },
    {
      "name": "BARCLAYS",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "FERNANDES Patrick"
            },
            {
              "name": "BOYER Joël"
            }
          ]
        }
      ]
    },
    {
      "name": "ALLIANZ",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "FALZON Eric C CP"
            }
          ]
        }
      ]
    },
    {
      "name": "ORANGE Transverse",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "Stanislas SANTOS"
            },
            {
              "name": "Berrada Marouane"
            },
            {
              "name": "JOIGNEAU Francis"
            },
            {
              "name": "AVISSEAU Paul D FE"
            },
            {
              "name": "Boutet Lionel"
            },
            {
              "name": "TOUSSAINT Catherine"
            },
            {
              "name": "PEPIN, Gabrielle"
            },
            {
              "name": "SAHAI Ali"
            },
            {
              "name": "LE HEN Clémence"
            },
            {
              "name": "GILLOT Matthieu C"
            },
            {
              "name": "SICHER Sebastien C AR"
            }
          ]
        }
      ]
    },
    {
      "name": "SANOFI",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "HETAULT pierre marie D"
            },
            {
              "name": "CAPGEN Léa"
            },
            {
              "name": "NEDJAR, Nassima Sihem"
            }
          ]
        }
      ]
    },
    {
      "name": "BPI",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "TMA AGORA"
            },
            {
              "name": "MADANI Ayoub"
            }
          ]
        }
      ]
    },
    {
      "name": "ORANGE BANK",
      "children": [
        {
          "name": "STAGAIRES",
          "children": [
            {
              "name": "TUEKAM Denis"
            },
            {
              "name": "Daniel Ly"
            },
            {
              "name": "HARFOUCHE Sarra"
            },
            {
              "name": "Chamseddhine EL GUET"
            },
            {
              "name": "YAHI Lina"
            }
          ]
        }
      ]
    },
    {
      "name": "Euler",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "ASSOGBA Jocelyne"
            },
            {
              "name": "FRITZ Fabien"
            }
          ]
        }
      ]
    },
    {
      "name": "ORANGE Build",
      "children": [
        {
          "name": "Backbase",
          "children": [
            {
              "name": "LE CHATON Vincent"
            },
            {
              "name": "HALMI Rime"
            },
            {
              "name": "WU, Qindi"
            },
            {
              "name": "LIORET, Mathieu"
            },
            {
              "name": "AL MAROUNI, Marouane"
            },
            {
              "name": "KHATER Youness"
            },
            {
              "name": "Abderrahmane BOULOUJOUR"
            },
            {
              "name": "Thomas Delannoy"
            },
            {
              "name": "SOUKAKI Mouhcine"
            },
            {
              "name": "PAUWAWE Eric"
            },
            {
              "name": "Johann Cassagne"
            },
            {
              "name": "Benoït Basdevant"
            },
            {
              "name": "TRIGUI Zine Soufien"
            }
          ]
        }
      ]
    },
    {
      "name": "SG",
      "children": [
        {
          "name": "Other",
          "children": [
            {
              "name": "COLOMBANI Marie-therese (BSC)"
            },
            {
              "name": "MORSI Nisrine C CP"
            }
          ]
        },
        {
          "name": "SG PEGA AT",
          "children": [
            {
              "name": "AHMAT Aicha Latifa"
            },
            {
              "name": "NIGGEMANN Marc Antoine"
            },
            {
              "name": "ZIACHI Mohammed"
            }
          ]
        },
        {
          "name": "PEGA CASE MANAGMENT",
          "children": [
            {
              "name": "AMORY Rémi"
            },
            {
              "name": "Nicolas Marquet C CP"
            },
            {
              "name": "Patrick Malbos"
            }
          ]
        },
        {
          "name": "CREDIT DU NORD",
          "children": [
            {
              "name": "POLET Arnaud D CP"
            }
          ]
        }
      ]
    },
    {
      "name": "SCOR",
      "children": [
        {
          "name": "OMEGA2",
          "children": [
            {
              "name": "GUILLAUD Augustin"
            }
          ]
        }
      ]
    },
    {
      "name": "Orange SCRUM MASTERS",
      "children": [
        {
          "name": "SCRUM MASTERS",
          "children": [
            {
              "name": "MORTEMOUSQUE Pierre-Lou"
            },
            {
              "name": "LEFEBVRE Thibault"
            },
            {
              "name": "HIJAZI Adrien"
            }
          ]
        }
      ]
    },
    {
      "name": "Natixis",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "BEN FREDJ Hassen"
            },
            {
              "name": "DOBRZELEWSKI Thomas"
            },
            {
              "name": "GISCLARD Olivier"
            },
            {
              "name": "LE Joseph"
            }
          ]
        },
        {
          "name": "Financement",
          "children": [
            {
              "name": "CHEDEAU Stéphane"
            }
          ]
        },
        {
          "name": "DEV MOBIL",
          "children": [
            {
              "name": "SAOUZANET Jean - Baptiste"
            },
            {
              "name": "NABIL Salah Eddine"
            },
            {
              "name": "Jérémy Ciamous"
            }
          ]
        },
        {
          "name": "SALESFORCE - FACTOR",
          "children": [
            {
              "name": "JARROIR Alexis"
            }
          ]
        },
        {
          "name": "SALESFORCE - LEASE",
          "children": [
            {
              "name": "COBIGO Damien"
            },
            {
              "name": "JANKOVIC Radoica C SF"
            }
          ]
        }
      ]
    },
    {
      "name": "AXA",
      "children": [
        {
          "name": "Creditor",
          "children": [
            {
              "name": "LAVAL Aurélien"
            },
            {
              "name": "ALIOUECHE Yacine"
            },
            {
              "name": "Marc Denis"
            },
            {
              "name": "BENSOUDA KORACHI Omar"
            },
            {
              "name": "ELHARKATI Ismail"
            },
            {
              "name": "ZWOLINSKI Cédric A SF (31/12)"
            },
            {
              "name": "LE CLECH Pascal C BA"
            },
            {
              "name": "GONCALVES Joao Paulo C"
            },
            {
              "name": "GUY Simon"
            },
            {
              "name": "ASSIGA ABOUMA Joseph"
            }
          ]
        },
        {
          "name": "GS Responsable BAU",
          "children": [
            {
              "name": "ARTEBAS Amira"
            }
          ]
        },
        {
          "name": "CRM AGENTS",
          "children": [
            {
              "name": "BADI Hassan"
            },
            {
              "name": "LAMENTA Théo"
            }
          ]
        },
        {
          "name": "CRM AGENTS - STAGIAIRE",
          "children": [
            {
              "name": "Medhi LAKBIR"
            }
          ]
        }
      ]
    },
    {
      "name": "CA",
      "children": [
        {
          "name": "CALF",
          "children": [
            {
              "name": "AMAT Jérôme C"
            },
            {
              "name": "ZERIATE Sofiane C"
            },
            {
              "name": "ILAMBO ISOMBECO Jonathan"
            },
            {
              "name": "LEURQUIN Mathieu"
            },
            {
              "name": "PIERSON Nicolas"
            },
            {
              "name": "QUENTIN Franck C"
            },
            {
              "name": "LELEONY Pierre 05/09/2016 C"
            },
            {
              "name": "BOUSETTA Yazid"
            },
            {
              "name": "TRAN Jean-Lucas"
            },
            {
              "name": "THORR Antoine"
            }
          ]
        },
        {
          "name": "CALF-STAGIAIRE",
          "children": [
            {
              "name": "Khalid ELMESSOUDI"
            },
            {
              "name": "KATEU Landry"
            },
            {
              "name": "TERTIUC Afanasie"
            },
            {
              "name": "NIVET Pierre"
            }
          ]
        }
      ]
    },
    {
      "name": "Orange RT",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "DARAMY Maxime"
            },
            {
              "name": "HAMA DJIBOU Tahirou"
            },
            {
              "name": "IKHELEF Massinissa"
            }
          ]
        }
      ]
    },
    {
      "name": "BNPP",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "Xavier Berdugo"
            },
            {
              "name": "BARRAUD David"
            },
            {
              "name": "BOURASSIN Olivier D"
            },
            {
              "name": "LAGACHE Thomas"
            }
          ]
        },
        {
          "name": "Saint Ouen",
          "children": [
            {
              "name": "Burie David"
            }
          ]
        },
        {
          "name": "CIB",
          "children": [
            {
              "name": "KHABOU Lina"
            },
            {
              "name": "DENIS WARD DONCOEUR frantz johann"
            }
          ]
        },
        {
          "name": "Core TEAM",
          "children": [
            {
              "name": "AAD Daniel"
            },
            {
              "name": "GUILLE Fabienne"
            },
            {
              "name": "AUNON Manuel D DY"
            },
            {
              "name": "LEZE Jérôme D CP"
            }
          ]
        }
      ]
    },
    {
      "name": "ORANGE build",
      "children": [
        {
          "name": "Backbase",
          "children": [
            {
              "name": "BEAUME Sébastien"
            },
            {
              "name": "WABO NOUBISSI Fabrice"
            },
            {
              "name": "CHOCHON Jeremy"
            },
            {
              "name": "Souad Kadri"
            },
            {
              "name": "Mohamed SAFI"
            },
            {
              "name": "MANORANJITHAN Janany"
            },
            {
              "name": "Antoine Frère"
            },
            {
              "name": "CHALI Yanis"
            },
            {
              "name": "DJIBO Yacouba"
            },
            {
              "name": "BOUKASSEM Yassine"
            },
            {
              "name": "POITE Guillaume"
            },
            {
              "name": "BOUNOUAR Sonia"
            },
            {
              "name": "CRENDAL Cécile"
            },
            {
              "name": "TOISON Nicolas"
            },
            {
              "name": "AMZAL FLORA"
            }
          ]
        }
      ]
    },
    {
      "name": "suressnes",
      "children": [
        {
          "name": "Management",
          "children": [
            {
              "name": "Anthony Joseph"
            },
            {
              "name": "Aurélien DIEHL"
            },
            {
              "name": "Lionel Evon"
            },
            {
              "name": "Léa LE FAUCHEUR"
            }
          ]
        },
        {
          "name": "INTERNE - Make it Happen",
          "children": [
            {
              "name": "WAMPE Patick"
            },
            {
              "name": "GARCIA Alexandre"
            },
            {
              "name": "TEKA CHENJOU"
            },
            {
              "name": "Franklin Diego"
            },
            {
              "name": "ASSANI Chaima"
            }
          ]
        }
      ]
    },
    {
      "name": "SET",
      "children": [
        {
          "name": "Multiprojet",
          "children": [
            {
              "name": "CAILLY bastien"
            },
            {
              "name": "Jean-luc Antoine E SF"
            },
            {
              "name": "LE HENAFF Jean-Pierre E AR"
            },
            {
              "name": "LEJAY Jean-Louis"
            }
          ]
        },
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "MOREL D'ARLEUX Thierry"
            },
            {
              "name": "FERNANDES"
            }
          ]
        }
      ]
    },
    {
      "name": "SURESSNES",
      "children": [
        {
          "name": "Interco",
          "children": [
            {
              "name": "PRUNIER Anne Caroline"
            },
            {
              "name": "CANDASSAMY Bala"
            },
            {
              "name": "KRESLINA FOURNIER Maija C SF"
            },
            {
              "name": "MIZRAHI Tomas"
            },
            {
              "name": "MA Xin"
            },
            {
              "name": "Sophie moulinier"
            },
            {
              "name": "DJAID mohamed"
            },
            {
              "name": "HUDELOT Alexandre"
            },
            {
              "name": "FAQIR Yassine"
            },
            {
              "name": "PICOREAU Angélique"
            },
            {
              "name": "AWAD Derick"
            },
            {
              "name": "VIRION Félix"
            }
          ]
        }
      ]
    },
    {
      "name": "LCL",
      "children": [
        {
          "name": "CRM",
          "children": [
            {
              "name": "NAIRAINCE Johan C AR"
            },
            {
              "name": "SAUTIER Arnaud"
            },
            {
              "name": "LAURENT Jean-François D"
            },
            {
              "name": "TENKORANG Joanne"
            }
          ]
        },
        {
          "name": "DIGITAL APP (AT)",
          "children": [
            {
              "name": "ABBACI Samir B"
            },
            {
              "name": "BOOMBO MUHINDO Dany"
            }
          ]
        }
      ]
    },
    {
      "name": "Groupama",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "FUILU Jonathan"
            },
            {
              "name": "NGUEPI DONGMO Ghislain"
            }
          ]
        },
        {
          "name": "COLLECTIVES",
          "children": [
            {
              "name": "DULMAN Nicolas"
            }
          ]
        }
      ]
    },
    {
      "name": "ING",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "TAFNI Amara"
            }
          ]
        }
      ]
    },
    {
      "name": "CA",
      "children": [
        {
          "name": "CAAGIS",
          "children": [
            {
              "name": "BOUDABLIJ Anas"
            },
            {
              "name": "LEGROS Olivier"
            }
          ]
        },
        {
          "name": "CACEIS",
          "children": [
            {
              "name": "KTARI Dhia"
            }
          ]
        },
        {
          "name": "CACEIS - Stagiaire",
          "children": [
            {
              "name": "NANITELIAMO Arnold"
            }
          ]
        }
      ]
    },
    {
      "name": "HSBC",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "PERIGAULT Erwan D"
            },
            {
              "name": "Raoul Hippolyte"
            },
            {
              "name": "NZALI KOUONTCHOU"
            },
            {
              "name": "CERUTI Philippe"
            },
            {
              "name": "BONNIOL NICOLAS"
            },
            {
              "name": "FOUCAULT Aurélien"
            },
            {
              "name": "DECRUYENAERE David"
            }
          ]
        }
      ]
    },
    {
      "name": "Euroclear",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "CHEBAH Lyes"
            }
          ]
        }
      ]
    },
    {
      "name": "Caisse d'épargne",
      "children": [
        {
          "name": "Assistance Technique",
          "children": [
            {
              "name": "DE BEAUREPAIRE Guillaume"
            }
          ]
        }
      ]
    },
    {
      "name": "La Banque Postale",
      "children": [
        {
          "name": "Assitance Technique",
          "children": [
            {
              "name": "HENRY Jean Philippe"
            }
          ]
        },
        {
          "name": "SALESFORCE",
          "children": [
            {
              "name": "MOLINE Vincent C CP"
            },
            {
              "name": "VIAL Jeremy"
            },
            {
              "name": "LAUNAY Maxime"
            },
            {
              "name": "MERABTI Ibrahim"
            }
          ]
        },
        {
          "name": "SALESFORCE- STAGIARE",
          "children": [
            {
              "name": "LE VAN Thien-an"
            }
          ]
        }
      ]
    }
  ]
};

var diameter = 2048;

var margin = {top: 20, right: 120, bottom: 20, left: 120},
        width = diameter,
        height = diameter;

var i = 0,
        duration = 350,
        root;

var tree = d3.layout.tree()
        .size([360, diameter / 2 - 80])
        .separation(function (a, b) {
            return (a.parent == b.parent ? 5 : 10) / a.depth;
        });

var diagonal = d3.svg.diagonal.radial()
        .projection(function (d) {
            return [d.y, d.x / 180 * Math.PI];
        });

var svg = d3.select("body")
        .style("text-align","center")
        .style("margin", "0 auto")
        .append("svg")
        .attr("class", "rootSVG")
        .attr("width",width)
        .attr("height",height )
        .append("g")
        .attr("transform", "translate(" + diameter / 2 + "," + diameter / 2 + ")");

var circleR = 30;

root = pubs;
root.x0 = height / 2;
root.y0 = 0;

//root.children.forEach(collapse); // start with all children collapsed
update(root);

root.children.forEach(function (d) { 
  d.children.forEach(function (d) { 
    collapse(d);
  })
});

update(root);

d3.select(self.frameElement).style("height", "800px");

function update(source) {

    // Compute the new tree layout.
    var nodes = tree.nodes(root),
            links = tree.links(nodes);

    // Normalize for fixed-depth.
    nodes.forEach(function (d) {
        if (d.depth <= 1){
        //d.y = 250;
        d.y = d.depth * 200;
    }
    else if (d.depth == 2){
        //  d.y = 500;
        d.y = d.depth * 250;
    }
    else {
        // d.y = 750;
        d.y = d.depth * 300;
    }
  });
  

    // Update the nodes…
    var node = svg.selectAll("g.node")
            .data(nodes, function (d) {
                return d.id || (d.id = ++i);
            });

    // Enter any new nodes at the parent's previous position.
    var nodeEnter = node.enter().append("g")
            .attr("class", "node")
            .attr("transform", function(d) { return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")"; })
            .on("click", click);

    nodeEnter.append("circle")
            .attr("r", 1e-6)
            .style("fill", function (d) {
                return d._children ? "lightsteelblue" : "#fff";
            });

    nodeEnter.append("text")
            .attr("x", function(d) { 
              if (d.depth == 3) {
                if (d.x < 180) { 
                  return circleR+5;
                } else {
                  return circleR-5;
                }
              } else {
                if (d.x < 180) { 
                  return -circleR-5;
                } else {
                  return 95;
                }
              }
            })
            .attr("dy", function(d) {
              if (d.depth == 3) {
                return "0.35em";
              } else {
                return "-0.6em";
              }
            })
            //.attr("text-anchor", "start")
            .attr("text-anchor", function(d) { 
              if (d.depth == 3) { 
                if (d.x < 180) { 
                  return "start";
                } else {
                  return "end";
                } 
              }
              if (d.depth == 2) { 
                if (d.x < 180) { 
                  return "end";
                } else {
                  return "start";
                } 
              }
            })
            //.attr("transform", function(d) { return d.x < 180 ? "translate(0)" : "rotate(180)translate(-" + (d.name.length * 8.5)  + ")"; })
            .text(function (d) {
                if (d.depth>1) { 
                    return d.name;
                } else
                {
                    return "";
                }
            })
            .style("fill-opacity", 1e-6);

    // nodeEnter.append("text")
    //   .attr("x", function(d) { return d.children || d._children ? -20 : 20; })
    //   .attr("dy", "1.35em")
    //   .attr("text-anchor", function(d) { return d.children || d._children ? "end" : "start"; })
    //   .text(function(d) { return d.name; })
    //   .style("fill-opacity", 1e-6);



    nodeEnter
            .append('defs')
            .append('pattern')
            .attr('id', function (d, i) {
                return 'pic_' + deleteSpace(d.name);
            })
            .attr('height', 1)
            .attr('width', 1)
            .attr('x', 0)
            .attr('y', 0)
            .append('image')
            .attr('xlink:href', function (d, i) {
              // if (d.depth == 0){
              //       return "imagesDCX/DCX.jpg";
              //   } else
              //   return "imagesCollaborateurs/"+d.name+".jpg";
                return "Maumon, Elisabeth Cropped.jpg";
            })
            // .attr('height', 40)
            // .attr('width', 40)
            .attr('height', function(d){ return 2*circleR })
            .attr('width', function(d){ return circleR*2})
            .attr('x', 0)
            .attr('y', 0);


    nodeEnter.on("mouseover", function (d) {
      console.log(d.x);
        d3.select(this).select('circle').attr("r",2*circleR)
        //console.log(d3.select(this).select('circle').attr("r",2*circleR));
        d3
        .select(this)
        .select('defs').select('pattern').select('image')
        .attr('height', function(d){ return 4*circleR })
        .attr('width', function(d){ return 4*circleR });
    });
    
    nodeEnter.on("mouseout", function () {
        d3.select(this).select('circle').attr("r",circleR)
        //console.log(d3.select(this).select('circle').attr("r",2*circleR));
        d3
        .select(this)
        .select('defs').select('pattern').select('image')
        .attr('height', function(d){ return 2*circleR })
        .attr('width', function(d){ return 2*circleR });
    });

    // nodeEnter.select("circle")
    //         .on("mouseover", function(d){
    //             d3.select(this).attr("r",2*circleR);
    //             console.log(d3.select('pattern'));
    //             console.log(this);
    //             //console.log(d3.select('image'));
    //             //d3.select('image').attr('height', function(d){ return 4*circleR });
    //         });

    //  nodeEnter.select("circle")
    //         .on("mouseout", function(d){
    //             d3.select(this).attr("r",circleR);
    //         });

    //  nodeEnter.select("defs")
    //         .on("mouseover", function(d){
    //             console.log('gsgs');
    //             //d3.select(this).select('defs').select('image').attr('height', function(d){ return 4*circleR });
    //             //d3.select(this).select('defs').select('image').attr('width', function(d){ return circleR*4});
    //         });
    
    //  nodeEnter.select("image")
    //         .on("mouseout", function(d){
    //             d3.select(this).attr('height', function(d){ return 4*circleR });
    //             d3.select(this).attr('width', function(d){ return circleR*4});
    //         });
    
    // Transition nodes to their new position.
    var nodeUpdate = node.transition()
            .duration(duration)
            .attr("transform", function (d) {
                //return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")";
                return "rotate(" + (d.x - 90) + ")translate(" + d.y + ")";
            });

    nodeUpdate.select("circle")
            .attr("r", 4.5)
            .style("fill", function (d) {
                return d._children ? "lightsteelblue" : "#fff";
            });

    nodeUpdate.select("text")
            .style("fill-opacity", 1)
            .attr("transform", function (d) {
                return d.x < 180 ? "translate(0)" : "rotate(180)translate(-" + (d.name.length + 50) + ")";
            });

    
    nodeUpdate.select("circle")
            .attr("r",circleR)
            .style("fill", function (d, i) {
                return 'url(#pic_' + deleteSpace(d.name) + ')';
            });

    nodeUpdate.selectAll("circle").attr("transform", function (d) {
        return "rotate(" + (-1 * d.x + 90) + ")";
    }); 

    // TODO: appropriate transform
    var nodeExit = node.exit().transition()
            .duration(duration)
            .attr("transform", function(d) { return "diagonal(" + source.y + "," + source.x + ")"; })
            .remove();

    nodeExit.select("circle")
            .attr("r", 1e-6);

    nodeExit.select("text")
            .style("fill-opacity", 1e-6);

    // Update the links…
    var link = svg.selectAll("path.link")
            .data(links, function (d) {
                return d.target.id;
            });

    // Enter any new links at the parent's previous position.
    link.enter().insert("path", "g")
            .attr("class", "link")
            .attr("d", function (d) {
                var o = {x: source.x0, y: source.y0};
                return diagonal({source: o, target: o});
            });

    // Transition links to their new position.
    link.transition()
            .duration(duration)
            .attr("d", diagonal);

    // Transition exiting nodes to the parent's new position.
    link.exit().transition()
            .duration(duration)
            .attr("d", function (d) {
                var o = {x: source.x, y: source.y};
                return diagonal({source: o, target: o});
            })
            .remove();

    // Stash the old positions for transition.
    nodes.forEach(function (d) {
        d.x0 = d.x;
        d.y0 = d.y;
    });



     /*   
      var levelWidth = [1];
var childCount = function(level, n) {
  if(n.children && n.children.length > 0) {
    if(levelWidth.length <= level + 1) levelWidth.push(0);
    levelWidth[level+1] += n.children.length;
    n.children.forEach(function(d) {
      childCount(level + 1, d);
    });
  }
};
childCount(0, root);  
var newHeight = d3.max(levelWidth) * 20; // 20 pixels per line  
tree = tree.size([newHeight, w]);*/
}

// Toggle children on click.
function click(d) {
    if (d.children) {
        d._children = d.children;
        d.children = null;
    } else {
        d.children = d._children;
        d._children = null;
    }

  //    if ( (d.depth >= 2) && (d.children!=null)) {
  //       diameter = diameter + 180;
  //       document.getElementsByClassName("rootSVG")[0].setAttribute("width", diameter);
  //       document.getElementsByClassName("rootSVG")[0].setAttribute("height", diameter);
  //       document.getElementsByClassName("rootSVG")[0].setAttribute("transform", "translate(" + diameter/2 + ", " + diameter/2 + ")");
  //       document.body.setAttribute("text-align","center");
  // }

    update(d);
}

// Collapse nodes
function collapse(d) {
    if (d.children) {
        d._children = d.children;
        d._children.forEach(collapse);
        d.children = null;
    }
}
function deleteSpace(s) { 
return s.replace(/ /g, "");
} 